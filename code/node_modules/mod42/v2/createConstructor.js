var assign = require("assign42/v1")().fn;
var track = require("track42");
var is= require("util42").is;

var createConstructor = function(name){
	eval("var " + name + ";");
	var constructor = eval("(" + name + " = function " + name + "(){\r\n\
	if (!(this instanceof " + name + "))\r\n\
		return new (" + name + ".bind.apply(" + name + ", [null].concat([].slice.call(arguments)) ));\r\n\
	track(this); \r\n\
	var ret = this.instantiate.apply(this, arguments);\r\n\
	if (is.def(ret)) return ret;\r\n\
});");
	constructor.assign = assign;
	constructor.prototype.assign = assign;
	return constructor;
};

module.exports = createConstructor;