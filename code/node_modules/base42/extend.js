var track = require("track42");

var extend = function(o){
	var name, Ext;

	name = (o && o.name) || (this.name + "Ext");
	if (o && o.name)
		delete o.name; // otherwise it gets assigned to prototype...
	
	Ext = this.createConstructor(name);

	Ext.assign = this.assign;

	// Constructor.props
	if (Ext.assign.dumb)
		Ext.assign.dumb(Ext, this);
	else
		Ext.assign(this);
	
		track(Ext);
		Ext.base = this;

	// Setup inheritance
	Ext.prototype = Object.create(this.prototype);
		track(Ext.prototype);
		Ext.prototype.constructor = Ext;
		Ext.prototype.name = Ext.name[0].toLowerCase() + Ext.name.substring(1);

	// Use .assign to add/override prototype properties
	Ext.prototype.assign.apply(Ext.prototype, arguments);

	return Ext;
};

module.exports = extend;