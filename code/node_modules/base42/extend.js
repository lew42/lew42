var track = require("track42");

var extend = function(o){
	var name, Ext;

	if (o && o.name){
		name = o.name;
		delete o.name;
	} else {
		name = this.name + "Ext";
	}
	
	Ext = this.createConstructor(name);

	Ext.assign = this.assign;

	// Constructor.props
	Ext.assign(this);
		// the above assign will assign `Ext.id = this.id`, so track has to come after assign
		track(Ext);
		// Same with .base
		Ext.base = this;

	// Setup inheritance
	Ext.prototype = Object.create(this.prototype);
		track(Ext.prototype);
		Ext.prototype.constructor = Ext;
		Ext.prototype.name = Ext.name[0].toLowerCase() + Ext.name.substring(1);

	// Use .assign to add/override prototype properties
	Ext.prototype.assign.apply(Ext.prototype, arguments);

	return Ext;
};

module.exports = extend;